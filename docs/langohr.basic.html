<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>langohr.basic documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Langohr</span> <span class="project-version">5.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>langohr</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>amqp091</span></div></div></li><li class="depth-3"><a href="langohr.amqp091.inspection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inspection</span></div></a></li><li class="depth-2 branch current"><a href="langohr.basic.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>basic</span></div></a></li><li class="depth-2 branch"><a href="langohr.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-2 branch"><a href="langohr.confirm.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>confirm</span></div></a></li><li class="depth-2 branch"><a href="langohr.consumers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>consumers</span></div></a></li><li class="depth-2 branch"><a href="langohr.conversion.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conversion</span></div></a></li><li class="depth-2 branch"><a href="langohr.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="langohr.exchange.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exchange</span></div></a></li><li class="depth-2 branch"><a href="langohr.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-2 branch"><a href="langohr.queue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>queue</span></div></a></li><li class="depth-2 branch"><a href="langohr.shutdown.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shutdown</span></div></a></li><li class="depth-2 branch"><a href="langohr.tx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tx</span></div></a></li><li class="depth-2"><a href="langohr.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="langohr.basic.html#var-ack"><div class="inner"><span>ack</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-add-return-listener"><div class="inner"><span>add-return-listener</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-cancel"><div class="inner"><span>cancel</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-consume"><div class="inner"><span>consume</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-get"><div class="inner"><span>get</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-nack"><div class="inner"><span>nack</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-publish"><div class="inner"><span>publish</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-qos"><div class="inner"><span>qos</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-recover"><div class="inner"><span>recover</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-reject"><div class="inner"><span>reject</span></div></a></li><li class="depth-1"><a href="langohr.basic.html#var-return-listener"><div class="inner"><span>return-listener</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">langohr.basic</h1><div class="doc"><pre class="plaintext">Functions that cover basic.* protocol methods: publishing and consumption
of messages, acknowledgements.

Relevant guides:

* <a href="http://clojurerabbitmq.info/articles/queues.html">http://clojurerabbitmq.info/articles/queues.html</a>
* <a href="http://clojurerabbitmq.info/articles/exchanges.html">http://clojurerabbitmq.info/articles/exchanges.html</a></pre></div><div class="public anchor" id="var-ack"><h3>ack</h3><div class="usage"><code>(ack channel delivery-tag)</code><code>(ack channel delivery-tag multiple)</code></div><div class="doc"><pre class="plaintext">Acknowledges one or more messages using basic.ack AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L202">view source</a></div></div><div class="public anchor" id="var-add-return-listener"><h3>add-return-listener</h3><div class="usage"><code>(add-return-listener channel f)</code></div><div class="doc"><pre class="plaintext">Adds return listener to the given channel
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L139">view source</a></div></div><div class="public anchor" id="var-cancel"><h3>cancel</h3><div class="usage"><code>(cancel channel consumer-tag)</code></div><div class="doc"><pre class="plaintext">Cancels a consumer (subscription) using basic.cancel AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L177">view source</a></div></div><div class="public anchor" id="var-consume"><h3>consume</h3><div class="usage"><code>(consume ch queue consumer)</code><code>(consume ch queue consumer {:keys [consumer-tag auto-ack exclusive arguments no-local], :or {consumer-tag "", auto-ack false, exclusive false, no-local false}})</code></div><div class="doc"><pre class="plaintext">Adds new consumer to a queue using basic.consume AMQP 0.9.1 method.

Called with default parameters, starts non-nolocal, non-exclusive consumer with explicit acknowledgement and server-generated consumer tag.

^String queue - the name of the queue
^Consumer consumer - callback to receive notifications and messages from a queue by subscription. For more information about consumers, check out langohr.consumers ns.

Options:

  ^String :consumer-tag: a unique consumer (subscription) identifier.
                         Omit the option or pass an empty string to make RabbitMQ generate one for you.
  ^Boolean :auto-ack (default false): true if the server should consider messages acknowledged once delivered,
                                      false if server should expect manual acknowledgements.
  ^Boolean :exclusive (default false): true if this is an exclusive consumer
                                       (no other consumer can consume given queue)</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L147">view source</a></div></div><div class="public anchor" id="var-get"><h3>get</h3><div class="usage"><code>(get channel queue)</code><code>(get channel queue auto-ack)</code></div><div class="doc"><pre class="plaintext">Fetches a message from a queue using basic.get AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L183">view source</a></div></div><div class="public anchor" id="var-nack"><h3>nack</h3><div class="usage"><code>(nack channel delivery-tag multiple requeue)</code></div><div class="doc"><pre class="plaintext">Negative acknowledgement of one or more messages using basic.nack AMQP 0.9.1 methods (a RabbitMQ-specific extension)
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L217">view source</a></div></div><div class="public anchor" id="var-publish"><h3>publish</h3><div class="usage"><code>(publish ch exchange routing-key payload)</code><code>(publish channel exchange routing-key payload {:keys [mandatory content-type content-encoding headers persistent priority correlation-id reply-to expiration message-id timestamp type user-id app-id cluster-id], :or {mandatory false}})</code></div><div class="doc"><pre class="plaintext">Publishes a message using basic.publish AMQP 0.9.1 method.

This method publishes a message to a specific exchange. The message will be routed to queues as defined by
the exchange configuration and distributed to any active consumers when the transaction, if any, is committed.

^String :exchange: name of the exchange to publish to. Can be an empty string, which means default exchange.
^String :routing-key: the routing key for the message. Used for routing messages depending on exchange configuration.

Payload can be anything the clojurewerkz.support.bytes/ByteSource protocol is extended for, Langohr ships with
an implementation for byte arrays and strings.

Options:
^Boolean :mandatory (default false): specifies reaction of server if the message can't be routed to a queue.


Basic properties:

  ^String :content content-type: MIME Content type
  ^String :content-encoding: MIME Content encoding
  ^Map :headers: headers that will be passed to subscribers, given in Map format.
  ^Boolean :persistent: should this message be persisted to disk?
  ^Integer :priority: message priority, number from 0 to 9
  ^String :correlation-id: application correlation identifier. Useful for cases when it's required to match request with the response.
                           Usually a unique value.
  ^String :reply-to: name of the reply queue.
  ^String :expiration: how long a message is valid
  ^String :message-id: message identifier
  ^Date :timestamp: timestamp associated with this message
  ^String :type: message type, can be in any format, e.g. search.requests.index
  ^String :user-id: user ID. RabbitMQ will validate this against the active connection user
  ^String :app-id: publishing application ID

Example:

    (lhb/publish channel exchange queue payload {:priority 8 :message-id msg-id :content-type content-type :headers { "key" "value" }})</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L54">view source</a></div></div><div class="public anchor" id="var-qos"><h3>qos</h3><div class="usage"><code>(qos channel prefetch-count)</code><code>(qos channel prefetch-size prefetch-count global)</code></div><div class="doc"><pre class="plaintext">Sets channel or connection prefetch level using basic.qos AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L194">view source</a></div></div><div class="public anchor" id="var-recover"><h3>recover</h3><div class="usage"><code>(recover channel)</code><code>(recover channel requeue)</code></div><div class="doc"><pre class="plaintext">Notifies RabbitMQ that it needs to redeliver unacknowledged messages using basic.recover AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L223">view source</a></div></div><div class="public anchor" id="var-reject"><h3>reject</h3><div class="usage"><code>(reject channel delivery-tag)</code><code>(reject channel delivery-tag requeue)</code></div><div class="doc"><pre class="plaintext">Rejects (and, optionally, requeues) a messages using basic.reject AMQP 0.9.1 method
</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L209">view source</a></div></div><div class="public anchor" id="var-return-listener"><h3>return-listener</h3><div class="usage"><code>(return-listener f)</code></div><div class="doc"><pre class="plaintext">Creates new return listener. Usually used in order to be notified of failed deliveries when basic-publish is called with :mandatory or :immediate flags set, but
message couldn't be delivered.

If the client has not configured a return listener for a particular channel, then the associated returned message will be silently dropped.

f: a handler function that accepts reply-code, reply-text, exchange, routing-key, properties and body as arguments.


Example:

   (let [f (langohr.basic/return-listener (fn [reply-code reply-text exchange routing-key properties body]
                                            (println reply-code reply-text exchange routing-key properties body)))]
     (.addReturnListener ch f))</pre></div><div class="src-link"><a href="https://github.com/michaelklishin/langohr/blob/v5.1.0/src/clojure/langohr/basic.clj#L120">view source</a></div></div></div></body></html>